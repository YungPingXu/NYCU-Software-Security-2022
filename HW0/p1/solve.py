from Crypto.Util.number import long_to_bytes

p = 92017932396773207330365205210913184771249549355771692523246399384571269833668487945963934319507538171501041280674304304879328757539798699280378034748542218248740777575679398093116579809607067129824965250071416089841516538588253944223235904445546895574651603636188746948921937704060334290364304972412697492577
enc = 87051682992840829567429886737255563980229964191963649650455667117285375334750716083826527488071966389632402954644144719710970265754062176648776448421065665281172133368294041777397049228273163978348132440822019295870429065335674151133125629968366491582233750452365390672536361224322642295053741696809519283644
hint = 112112804524582393858675176460595338484428048338611753655869733059768929120327158352572131172253127933611583356499525126040647290513660017529498493355846656594143774393256151536590212031416153303085867445488047592792290033548349001067687775149867134619114482370143917491889371548968347491490942978508386339813
k4 = 71337694139522244982715330159142042168006918029630729930667493233345673624428033212096454599489689393693878116503044658069046263113266928437784865852222607399307377673893146573417405720707711043610770180718533054453601226392617313437118804209768971485667456720473739540219762319907165473506225024012869782853
hint_k4 = hint ^ k4

k = [[], [], [], []]
for i in range(4):
    for j in range(1000 * i + 2, 1000 * (i + 1)):
        k[i].append(pow(j, 65537, p))

meet = {} # hint = k0 xor k1 xor k2 xor k3 xor k4 --> k0 xor k1 xor hint xor k4 = k2 xor k3
for i in range(998):
    for j in range(998):
        meet[k[0][i] ^ k[1][j] ^ hint_k4] = [k[0][i], k[1][j]] # record which keys

k0 = k1 = k2 = k3 = 0
for i in range(998):
    for j in range(998):
        if k[2][i] ^ k[3][j] in meet:
            tmp = meet[k[2][i] ^ k[3][j]]            
            k0 = tmp[0]
            k1 = tmp[1]
            k2 = k[2][i]
            k3 = k[3][j]

enc3 = pow(k4, -1, p) * enc % p
enc2 = pow(k3, -1, p) * enc3 % p
enc1 = pow(k2, -1, p) * enc2 % p
enc0 = pow(k1, -1, p) * enc1 % p
flag = pow(k0, -1, p) * enc0 % p
print(long_to_bytes(flag))